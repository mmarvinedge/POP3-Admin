<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core" xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:adm="http://github.com/adminfaces"
                template="#{layoutMB.template}"
                xmlns:pop="http://xmlns.jcp.org/jsf/composite/pop">

    <ui:define name="metadata">
        <ui:param name="title" value="Produtos" /> <!-- Automatic create breadCrumb and page title when param 'title' is provided. --> 

        <style type="text/css">
            .ui-datatable .ui-datatable-header {
                text-align: right !important;
            }
        </style>
    </ui:define>

    <ui:define name="description">
        Controle seus Produtos
    </ui:define>

    <ui:define name="body">
        <h:form id="frmProduct" >
            <p:focus context="@form"/>
            <div class="box box-primary">
                <div class="box-header with-border">
                    <div id="main-buttons" class="hidden-sm hidden-xs">
                        <p:commandButton action="#{productMB.novo}" icon="fa fa-plus" disabled="#{companyMB.company.integration}"
                                         value="Novo" styleClass="btn-primary" update="modalNewProduct" oncomplete="PF('modalNewProduct').show()"/>
                        <p:spacer width="5"/>
                        <p:splitButton value="Editar" action="#{productMB.setProductComplete()}" update="@(.ui-dialog)" styleClass="btn-info"
                                       disabled="#{empty productMB.selectedProducts or productMB.selectedProducts.size() > 1}"
                                       oncomplete="PF('modalNewProduct').show()" icon="fa fa-edit">
                            <p:menuitem styleClass="btn-primary" icon="fa fa-copy" value="Copiar" disabled="#{companyMB.company.integration}" action="#{productMB.copyProduct()}" immediate="true" update=":frmNewProduct" oncomplete="PF('modalNewProduct').show()"  />
                            <f:param name="acao" value="#{companyMB.company.integration}"/>
                        </p:splitButton>
                        <p:spacer width="5"/>
                        <p:commandButton value="Deletar" icon="fa fa-trash" styleClass="btn-danger"
                                         action="#{productMB.delete}"
                                         disabled="#{empty productMB.selectedProducts or productMB.selectedProducts.size() == 0}"
                                         process="@this" update="@form"
                                         >
                            <p:confirm header="Confirmação" message="Tem certeza?" icon="ui-icon-danger"/>
                        </p:commandButton>
                    </div>

                    <p:splitButton value="Novo" action="#{productMB.novo}"
                                   icon="fa fa-plus"  update="modalNewProduct" oncomplete="PF('modalNewProduct').show()"
                                   styleClass="hidden-md hidden-lg btn-primary">

                        <p:menuitem value="Editar" update="@(.ui-dialog)" action="#{productMB.setProductComplete()}"
                                    oncomplete="PF('modalNewProduct').show()"
                                    disabled="#{empty productMB.selectedProducts or productMB.selectedProducts.size() > 1}"
                                    icon="fa fa-edit"/>

                        <p:menuitem value="Deletar" action="#{productMB.delete}"
                                    process="@this" update="@form"
                                    disabled="#{empty productMB.selectedProducts or productMB.selectedProducts.size() == 0}"
                                    icon="fa fa-trash">
                            <p:confirm header="Confirmação" message="Tem certeza?" icon="ui-icon-danger"/>
                        </p:menuitem>
                    </p:splitButton>
                    <p:spacer height="20"/>

                    <h:panelGroup rendered="#{companyMB.company.integration}">
                        <div style="border: 1px; background-color: #ff8080; padding: 1%; border-radius: 17px;">
                            <strong>ATENÇÃO!</strong> <small>Você possui integração, portanto só são permitidas edições de regras exclusivas do cardápio, as demais alterações devem ser feitas em seu sistema, esta regra também se aplica à novos produtos.</small>
                        </div>
                        <p:spacer height="20"/>
                    </h:panelGroup>
                    <p:spacer height="20"/>
                    <div class="text-right">
                        <p:commandButton value="Ativar/inativar por categoria" styleClass="btn-danger" oncomplete="PF('mdlPararVenda').show()"
                                         update="@(.ui-dialog)"/>
                    </div>
                    <p:separator/>
                    <p:dataTable id="tblProduct" widgetVar="productsTable" var="p" value="#{productMB.productModel}" rows="10"
                                 rowKey="#{p.id}" paginator="true" emptyMessage="Nenhum Produto encontrado"
                                 paginatorPosition="bottom" selection="#{productMB.selectedProducts}"
                                 paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown} {JumpToPageDropdown}"
                                 currentPageReportTemplate="[ {startRecord} - {endRecord} de {totalRecords} ]"
                                 rowsPerPageTemplate="10,20,30,40,50" >

                        <p:ajax event="rowSelectCheckbox" update="@(.ui-button)"/>
                        <p:ajax event="rowUnselectCheckbox" update="@(.ui-button)"/>
                        <p:ajax event="rowSelect" update="@(.ui-button)"/>
                        <p:ajax event="rowUnselect" update="@(.ui-button)"/>
                        <p:ajax event="toggleSelect" update="@(.ui-button)"/>

                        <p:column selectionMode="multiple" width="5%" styleClass="align-center"/>

                        <p:column headerText="Código" sortBy="#{p.sku}" filterBy="#{p.sku}" style="width: 10% !important" filterMatchMode="contains">
                            <h:outputText value="#{p.sku}" />
                        </p:column>
                        <p:column headerText="Descricão" sortBy="#{p.name}" filterBy="#{p.name}" filterMatchMode="contains">
                            <h:outputText value="#{p.name}" />
                        </p:column>
                        <p:column headerText="Preço Venda" sortBy="#{p.price}" filterBy="#{p.price}" filterMatchMode="contains">
                            <h:outputText value="#{p.price}" >
                                <f:convertNumber type="currency"/>
                            </h:outputText>
                        </p:column>
                        <p:column headerText="Categoria" sortBy="#{p.categoryMain.name}" filterBy="#{p.categoryMain.name}" filterMatchMode="contains">
                            <h:outputText value="#{p.categoryMain.name}" />
                        </p:column>
                        <p:column headerText="Ativo" class="text-center" width="100" >
                            <p:selectBooleanButton offLabel="Não" onLabel="Sim" value="#{p.enabled}">
                                <p:ajax event="change" update="@this"  listener="#{productMB.update(p)}"/>
                            </p:selectBooleanButton>
                        </p:column>

                        <p:column headerText="Impressora" >
                            <p:selectOneMenu disabled="#{param['acao']}" value="#{p.printer}" filter="true" >
                                <f:selectItem itemLabel="NAO IMPRIMIR" itemValue="NAO IMPRIMIR"/>
                                <f:selectItem itemLabel="BEBIDAS" itemValue="BEBIDAS"/>
                                <f:selectItem itemLabel="SUCOS" itemValue="SUCOS"/>
                                <f:selectItem itemLabel="REFRIGERANTES" itemValue="REFRIGERANTES"/>
                                <f:selectItem itemLabel="COZINHA" itemValue="COZINHA"/>
                                <f:selectItem itemLabel="PIZZARIA" itemValue="PIZZARIA"/>
                                <f:selectItem itemLabel="SALAO" itemValue="SALAO"/>
                                <f:selectItem itemLabel="CHURRASCARIA" itemValue="CHURRASCARIA"/>
                                <f:selectItem itemLabel="SALAO 2" itemValue="SALAO2"/>
                                <f:selectItem itemLabel="SALAO 3" itemValue="SALAO3"/>
                                <p:ajax event="itemSelect" update="@this"  listener="#{productMB.update(p)}"/>
                            </p:selectOneMenu>
                        </p:column>
                        <!--                        <p:column headerText="*" width="50" >
                                                    <p:commandButton   styleClass="btn-primary" icon="fa fa-copy"  action="#{productMB.copyProduct(p)}" immediate="true" update=":frmNewProduct" oncomplete="PF('modalNewProduct').show()" />
                                                </p:column>-->

                    </p:dataTable>
                </div>
            </div>
            <p:confirmDialog global="true" showEffect="fade" hideEffect="fade" styleClass="box-danger box-solid">
                <p:commandButton value="Sim" type="button" styleClass="btn-material btn-primary ui-confirmdialog-yes"
                                 icon="fa fa-check"/>
                <p:commandButton value="Não" type="button" styleClass="btn-material btn-danger ui-confirmdialog-no"
                                 icon="fa fa-close"/>
            </p:confirmDialog>
        </h:form>




        <p:dialog widgetVar="modalNewProduct" id="modalNewProduct"  header="Cadastro de Produtos" draggable="false"
                  modal="true" position="top" responsive="false" resizable="false" positionType="absolute"
                  width="850" height="620" showEffect="clip" hideEffect="fold" closeOnEscape="true" >
            <h:form id="frmNewProduct">
                <p:tabView id="tabs">
                    <p:tab title="Dados do Produto">
                        <div class="box-primary">
                            <div class="ui-g ui-fluid">
                                <div class="ui-sm-3 ui-g-3 ">
                                    <p:outputLabel value="SKU" for="inptSku"/>
                                    <p:inputText id="inptSku" value="#{productMB.product.sku}" placeholder="Campo preenchido automáticamente"
                                                 disabled="#{param['acao']}" />
                                    <span class="help-block">
                                        <p:message for="inptSku" /> 
                                    </span>
                                </div>
                                <div class="ui-sm-6 ui-g-6 ">     
                                    <p:outputLabel value="Nome" for="inptName"/>
                                    <p:inputText id="inptName" value="#{productMB.product.name}" required="true" disabled="#{param['acao']}"/>
                                    <span class="help-block"> 
                                        <p:message for="inptName" /> 
                                    </span>
                                </div>
                                <div class="ui-sm-12 ui-g-3 ">
                                    <p:outputLabel value="Categoria" for="category"/>
                                    <p:selectOneMenu required="true" requiredMessage="Categoria é obrigatório"
                                                     value="#{productMB.product.categoryMain}" id="category" filter="true"
                                                     filterMatchMode="contains" effect="fade" converter="Converter" disabled="#{param['acao']}">
                                        <f:selectItem itemLabel="Selecione uma categoria..." itemValue=""/>
                                        <f:selectItems value="#{productMB.categoryList}" var="cats" itemValue="#{cats}" itemLabel="#{cats.name}"/>
                                        <p:ajax event="itemSelect" update="@this, :frmNewProduct:tabs:pnl2" listener="#{productMB.debug()}" />
                                    </p:selectOneMenu>
                                    <span class="help-block"> 
                                        <p:message for="category" /> 
                                    </span>
                                </div>
                            </div>
                            <div class="ui-g ui-fluid">

                                <div class="ui-sm-6 ui-g-3 ">     
                                    <p:outputLabel value="Impressora" for="inptPrinter"/>
                                    <p:selectOneMenu id="inptPrinter" value="#{productMB.product.printer}" 
                                                     filter="true" required="true" disabled="#{param['acao']}">
                                        <f:selectItem itemLabel="NAO IMPRIMIR" itemValue="NAO IMPRIMIR"/>
                                        <f:selectItem itemLabel="BEBIDAS" itemValue="BEBIDAS"/>
                                        <f:selectItem itemLabel="SUCOS" itemValue="SUCOS"/>
                                        <f:selectItem itemLabel="REFRIGERANTES" itemValue="REFRIGERANTES"/>
                                        <f:selectItem itemLabel="COZINHA" itemValue="COZINHA"/>
                                        <f:selectItem itemLabel="PIZZARIA" itemValue="PIZZARIA"/>
                                        <f:selectItem itemLabel="SALAO" itemValue="SALAO"/>
                                        <f:selectItem itemLabel="CHURRASCARIA" itemValue="CHURRASCARIA"/>
                                        <f:selectItem itemLabel="SALAO 2" itemValue="SALAO2"/>
                                        <f:selectItem itemLabel="SALAO 3" itemValue="SALAO3"/>
                                    </p:selectOneMenu>
                                    <span class="help-block"> 
                                        <p:message for="inptPrinter" /> 
                                    </span>
                                </div>
                                <div class="ui-sm-6 ui-g-3 ">     
                                    <p:outputLabel value="Preço" for="inptPrice"/>
                                    <p:inputNumber id="inptPrice" disabled="#{param['acao']}" symbol="R$ " decimalSeparator="," thousandSeparator="." value="#{productMB.product.price}" required="true"/>
                                    <span class="help-block"> 
                                        <p:message for="inptPrice" /> 
                                    </span>
                                </div>
                                <div class="ui-sm-6 ui-g-2 ">
                                    <p:outputLabel value="Promocional" for="promo"/><br/>
                                    <p:selectBooleanCheckbox id="promo" value="#{productMB.product.promo}" >
                                        <p:ajax event="change" update="ogirinalPrice" />
                                    </p:selectBooleanCheckbox>
                                </div>    
                                <div class="ui-sm-6 ui-g-3 ">
                                    <h:panelGroup id="ogirinalPrice" >
                                        <h:panelGroup rendered="#{productMB.product.promo}">
                                            <p:outputLabel value="Preço Original" for="inptPriceOriginal"/>
                                            <p:inputNumber id="inptPriceOriginal" symbol="R$ " decimalSeparator="," thousandSeparator="." value="#{productMB.product.priceOriginal}" required="true"/>
                                            <span class="help-block"> 
                                                <p:message for="inptPriceOriginal" /> 
                                            </span>
                                        </h:panelGroup>
                                    </h:panelGroup>
                                </div>     


                                <div class="ui-sm-6 ui-g-6 ">
                                    <p:outputLabel value="Descrição" for="inptObs"/>
                                    <p:inputTextarea id="inptObs" disabled="#{param['acao']}" value="#{productMB.product.description}" />
                                    <span class="help-block"> 
                                        <p:message for="inptObs" /> 
                                    </span>
                                </div>
                                <div class="ui-sm-6 ui-g-6 ">
                                    <div class="img-wrap">
                                        <p:outputLabel value="Foto (100KB max)" />
                                        <p:fileUpload fileUploadListener="#{productMB.uploadPhoto}" mode="advanced" dragDropSupport="false"
                                                      uploadLabel="Enviar" disabled="#{param['acao']}" cancelLabel="Cancelar" label="Escolher" auto="false"
                                                      update="photo" sizeLimit="500000" fileLimit="3"  />
                                        <hr/>
                                        <h:panelGroup id="photo">
                                            <h:panelGroup rendered="#{productMB.product.imageBase64 != null and productMB.product.imageBase64.startsWith('http')}">
                                                <img src="#{productMB.product.imageBase64}" style="width: 50%"/>
                                            </h:panelGroup>
                                            <h:panelGroup rendered="#{productMB.product.imageBase64 != null and !productMB.product.imageBase64.startsWith('http')}">
                                                <img src="data:image/png;base64, #{productMB.product.imageBase64}" style="width: 25%"/>
                                            </h:panelGroup>
                                        </h:panelGroup>
                                    </div>
                                </div>

                                <!--<div class="ui-sm-12 ui-g-8 ">
                                    <p:outputLabel value="URL Foto" />
                                    <p:inputText value="{productMB.product.imageBase64}" />
                                </div>-->
                            </div>
                        </div>
                    </p:tab>
                    <p:tab title="Regras" >
                        <p:panel id="pnl2" styleClass="box-primary cardMdl">

                            <div class="box-primary" style="width: 770px !important;">
                                <div class="ui-g ui-fluid">
                                    <div class="ui-sm-12 ui-g-8">
                                        <h:outputLabel value="Tipo do produto" /><br/>
                                        <p:selectOneButton id="buttonTipoProduto" value="#{productMB.type}">
                                            <f:selectItem itemValue="normal" itemLabel="Normal"/>
                                            <f:selectItem itemValue="pizza" itemLabel="Pizza" itemDisabled="#{productMB.product.categoryMain.name != 'Pizzas' and productMB.product.categoryMain.name != 'Pizzas Doces' and productMB.product.categoryMain.name != 'Italian Pizza Express'}"/>
                                            <p:ajax update="@this, typeProduct" event="change"/>
                                            <f:param value="#{companyMB.company.integration}" name="acao"/>
                                        </p:selectOneButton>
                                    </div>
                                </div>
                                <div class="ui-g ui-fluid">
                                    <h:panelGroup id="typeProduct">
                                        <h:panelGroup rendered="#{productMB.type == 'normal'}">

                                            <p:fieldset id="fdlAdicionais" legend="Adicionais" style="width: 770px;">
                                                <p:commandButton disabled="#{param['acao']}" icon="fa fa-plus"  class="btn-success" style="position: absolute !important;right: 5px !important;margin-top: -75px !important;width: auto;;" action="#{productMB.addAttributeCorrect()}" update="blockAtributes" immediate="true"  />

                                                <div class="ui-g ui-fluid" style="width: 745px !important;">
                                                    <h:panelGroup  layout="block" id="blockAtributes">
                                                        <div class="ui-sm-12 ui-g-12">

                                                            <ui:repeat id="rpt" value="#{productMB.product.attributes}" var="atr" varStatus="vari">
                                                                <p:accordionPanel id="acord">
                                                                    <p:tab title="#{atr.description == null ? 'Grupo' : atr.description}">
                                                                        <div class="ui-g ui-fluid">
                                                                            <div class="ui-sm-6 ui-g-6">
                                                                                Grupo
                                                                                <p:inputText disabled="#{param['acao']}" value="#{atr.description}" required="true" >
                                                                                    <p:ajax event="blur" update="@this" />
                                                                                </p:inputText>
                                                                            </div>

                                                                            <div class="ui-sm-2 ui-g-2">
                                                                                Max
                                                                                <p:inputText disabled="#{param['acao']}" value="#{atr.quantity}" required="true" >
                                                                                    <p:ajax event="blur" update="@this" />
                                                                                </p:inputText>
                                                                            </div>
                                                                            <div class="ui-sm-2 ui-g-2">
                                                                                Parar a venda?
                                                                                <p:selectBooleanButton offLabel="Não" onLabel="Sim" value="#{atr.disabled}"/>
                                                                            </div>
                                                                            <div class="ui-sm-12 ui-g-12">
                                                                                <p:commandButton disabled="#{param['acao']}" icon="fa fa-plus" update=":frmNewProduct:tabs:rpt:#{vari.index}:acord:tblAttributes" class="btn-success" style="position: absolute !important;right: 60px !important;margin-top: -75px !important;width: 50px;;" action="#{productMB.addAttributeValue(atr)}"  immediate="true"  />
                                                                                <p:commandButton disabled="#{param['acao']}" icon="fa fa-trash"  class="btn-danger" style="position: absolute !important;right: 5px !important;margin-top: -75px !important;width: 50px;;" action="#{productMB.removeAtribute(atr)}"  immediate="true" update="@form"  />
                                                                                <p:dataTable value="#{atr.values}" var="att" id="tblAttributes" style="width: 100% !important;"
                                                                                             rowIndexVar="index" emptyMessage="Nenhum produto adicionado!"  >
                                                                                    <p:column  headerText="Parar a venda" width="90" style="text-align: left">
                                                                                        <p:selectBooleanButton offLabel="Não" onLabel="Sim" value="#{att.disabled}"/>
                                                                                    </p:column>
                                                                                    <p:column headerText="SKU" width="80" style="text-align: left">
                                                                                        <p:inputText disabled="#{param['acao']}" value="#{att.sku}"  placeholder="Opcional" >
                                                                                            <p:ajax event="blur" process="@this" />
                                                                                        </p:inputText>
                                                                                    </p:column>
                                                                                    <p:column headerText="Produto" style="text-align: left">
                                                                                        <p:inputText disabled="#{param['acao']}" id="addProduct" value="#{att.name}" required="true" requiredMessage="Produto é obrigatório">
                                                                                            <p:ajax event="blur" process="@this" />
                                                                                        </p:inputText>
                                                                                    </p:column>
                                                                                    <p:column headerText="Sinopse" style="text-align: left">
                                                                                        <p:inputText id="addSinopse" value="#{att.description}" required="false" requiredMessage="Sinopse do produto é obrigatória">
                                                                                            <p:ajax event="blur" process="@this" />
                                                                                        </p:inputText>
                                                                                    </p:column>
                                                                                    <p:column headerText="Preço" width="100" style="text-align: right">
                                                                                        <p:inputNumber disabled="#{param['acao']}" id="addPrice" symbol="R$ " decimalSeparator="," thousandSeparator="." value="#{att.price}" required="true" requiredMessage="Preço é obrigatório" >
                                                                                            <p:ajax event="blur" process="@this" />
                                                                                        </p:inputNumber>
                                                                                    </p:column>
                                                                                    <p:column width="60" style="text-align: center">
                                                                                        <center>
                                                                                            <p:commandButton disabled="#{param['acao']}" icon="fa fa-trash" styleClass="btn btn-danger" immediate="true" update="tblAttributes, @this" process="@this" action="#{productMB.removeAtributeValue(atr, index)}" />
                                                                                        </center>
                                                                                    </p:column>
                                                                                </p:dataTable>
                                                                            </div>
                                                                        </div>
                                                                    </p:tab>
                                                                </p:accordionPanel>

                                                            </ui:repeat>
                                                        </div>
                                                    </h:panelGroup>
                                                </div>
                                            </p:fieldset>
                                        </h:panelGroup>
                                        <h:panelGroup rendered="#{productMB.type == 'pizza' and (productMB.product.categoryMain.name == 'Pizzas' or productMB.product.categoryMain.name == 'Pizzas Doces' or productMB.product.categoryMain.name == 'Italian Pizza Express')}">
                                            <p:fieldset legend="Configuracoes de Pizza" style="width: 770px;">
                                                <div class="ui-g ui-fluid">
                                                    <div class="ui-sm-4 ui-g-4">
                                                        <p:outputLabel value="Tamanho"  for="tam"/>
                                                        <p:selectOneMenu disabled="#{param['acao']}" id="tam"  value="#{productMB.product.sizePizza}">
                                                            <f:selectItem itemLabel="Selecione" itemValue="" />
                                                            <f:selectItem itemLabel="Fatia" itemValue="Fatia" />
                                                            <f:selectItem itemLabel="Brotinho" itemValue="Brotinho" />
                                                            <f:selectItem itemLabel="Pequena" itemValue="Pequena" />
                                                            <f:selectItem itemLabel="Media" itemValue="Média" />
                                                            <f:selectItem itemLabel="Grande" itemValue="Grande" />
                                                            <f:selectItem itemLabel="Extra Grande" itemValue="Extra Grande" />
                                                            <f:selectItem itemLabel="Extra 1" itemValue="Extra 1" />
                                                            <f:selectItem itemLabel="Extra 2" itemValue="Extra 2" />
                                                            <f:selectItem itemLabel="Extra 3" itemValue="Extra 3" />
                                                        </p:selectOneMenu>
                                                    </div>
                                                    <div class="ui-sm-4 ui-g-3">
                                                        <p:outputLabel value="Máx Sabores Selecionaveis"  for="max"/>
                                                        <p:inputNumber disabled="#{param['acao']}" id="max"  value="#{productMB.product.maxPizza}"  decimalPlaces="0"/>
                                                    </div>
                                                </div>
                                                <div class="ui-g ui-fluid">
                                                    <div class="ui-sm-4 ui-g-4">
                                                        <p:outputLabel value="Regra de Preço"  for="reg"/>
                                                        <p:selectOneRadio disabled="#{param['acao']}" id="reg"  value="#{productMB.product.rulePricePizza}">
                                                            <f:selectItem itemLabel="Média" itemValue="Média" />
                                                            <f:selectItem itemLabel="Preço da Maior" itemValue="Maior" />
                                                        </p:selectOneRadio>
                                                    </div>
                                                </div>
                                                <div class="ui-g ui-fluid">
                                                    <div class="ui-sm-12 ui-g-12">
                                                        <p:outputLabel value="Sabores / Preço" /><br/>
                                                        <p:commandButton disabled="#{param['acao']}" icon="fa fa-plus" styleClass="btn-primary" style="position: absolute !important;right: 4% !important;margin-top: 0px !important;width: 8%;"
                                                                         action="#{productMB.addFlavor()}" update="tblFlavors"/>
                                                        <hr/>
                                                        <p:dataTable id="tblFlavors" value="#{productMB.product.flavorsPizza}" var="flav" editable="true" >
                                                            <p:column headerText="SKU" width="100" style="text-align: left">
                                                                <p:inputText value="#{flav.sku}" placeholder="Opcional" disabled="#{param['acao']}"/>
                                                            </p:column>
                                                            <p:column headerText="Sabor" width="150" style="text-align: left">
                                                                <p:inputText value="#{flav.flavor}" disabled="#{param['acao']}"/>
                                                            </p:column>
                                                            <p:column headerText="Sinopse">
                                                                <p:inputText value="#{flav.description}" style="width:100%" label="Descrição"/>
                                                            </p:column>
                                                            <p:column headerText="Preço" width="100">
                                                                <p:inputNumber symbol="R$ " decimalSeparator="," thousandSeparator="." value="#{flav.price}" disabled="#{param['acao']}" style="width:100%" label="Preço"/>
                                                            </p:column>

                                                            <p:column headerText="*" width="50">
                                                                <p:commandButton disabled="#{param['acao']}" styleClass="btn-danger" action="#{productMB.removeFlavor(flav)}" icon="fa fa-trash" update="tblFlavors" immediate="true"/>
                                                            </p:column>
                                                        </p:dataTable>
                                                    </div>
                                                    <div class="ui-sm-12 ui-g-12">

                                                    </div>

                                                </div>
                                            </p:fieldset>
                                        </h:panelGroup>
                                    </h:panelGroup>
                                </div>
                                <h:panelGroup rendered="#{companyMB.company.onlyMenu}">
                                    <p:fieldset legend="Regras do menu">
                                        <div class="ui-sm-6 ui-g-4 ">     
                                            <p:outputLabel value="Preço no menu" for="inptPriceMenu"/>
                                            <p:inputNumber id="inptPriceMenu" disabled="#{param['acao']}" symbol="R$ " decimalSeparator="," thousandSeparator="." value="#{productMB.product.priceMenu}"/><br/>
                                            <small>Insira um valor aqui caso o preço do seu produto seja diferente no menu</small>
                                        </div>
                                        <div class="ui-sm-6 ui-g-4 ">
                                            <p:outputLabel value="Vísivel somente no menu?" /><br/>
                                            <p:selectBooleanButton offLabel="Não" onLabel="Sim" value="#{productMB.product.onlyMenu}"/>
                                        </div>
                                    </p:fieldset>
                                </h:panelGroup>
                            </div>
                        </p:panel>
                    </p:tab>
                    <p:tab title="Disponibilidade" >
                        <p:panel  styleClass="box-primary cardMdl">
                            <div class="box-primary" style="width: 770px !important;">
                                <p:fieldset legend="Dias não vendidos">
                                    <div class="ui-g ui-fluid">
                                        <div class="ui-sm-12 ui-g-12">
                                            <table style="width: 100%; border: 1px solid gray; border-collapse: collapse;">
                                                <tr>
                                                    <th colspan="7" style="width: 100%; border: 1px solid black; border-collapse: collapse; padding: 15px; text-align: left;"><center>Habilite os dias que este produto não é vendido</center></th>
                                                </tr>
                                                <tr>
                                                    <th style="width: 14.28%; border: 1px solid black; border-collapse: collapse; padding: 15px; text-align: left;">Domingo</th>
                                                    <th style="width: 14.28%; border: 1px solid black; border-collapse: collapse; padding: 15px; text-align: left;">Segunda</th>
                                                    <th style="width: 14.28%; border: 1px solid black; border-collapse: collapse; padding: 15px; text-align: left;">Terça</th>
                                                    <th style="width: 14.28%; border: 1px solid black; border-collapse: collapse; padding: 15px; text-align: left;">Quarta</th>
                                                    <th style="width: 14.28%; border: 1px solid black; border-collapse: collapse; padding: 15px; text-align: left;">Quinta</th>
                                                    <th style="width: 14.28%; border: 1px solid black; border-collapse: collapse; padding: 15px; text-align: left;">Sexta</th>
                                                    <th style="width: 14.28%; border: 1px solid black; border-collapse: collapse; padding: 15px; text-align: left;">Sabado</th>
                                                </tr>
                                                <tr>
                                                    <td style="width: 14.28%; border: 1px solid black; border-collapse: collapse; padding: 15px; text-align: left;"><p:selectBooleanButton offLabel="Sim" onLabel="Não" value="#{productMB.product.productDay.naoVenderDom}" /></td>
                                                    <td style="width: 14.28%; border: 1px solid black; border-collapse: collapse; padding: 15px; text-align: left;"><p:selectBooleanButton offLabel="Sim" onLabel="Não" value="#{productMB.product.productDay.naoVenderSeg}" /></td>
                                                    <td style="width: 14.28%; border: 1px solid black; border-collapse: collapse; padding: 15px; text-align: left;"><p:selectBooleanButton offLabel="Sim" onLabel="Não" value="#{productMB.product.productDay.naoVenderTer}" /></td>
                                                    <td style="width: 14.28%; border: 1px solid black; border-collapse: collapse; padding: 15px; text-align: left;"><p:selectBooleanButton offLabel="Sim" onLabel="Não" value="#{productMB.product.productDay.naoVenderQua}" /></td>
                                                    <td style="width: 14.28%; border: 1px solid black; border-collapse: collapse; padding: 15px; text-align: left;"><p:selectBooleanButton offLabel="Sim" onLabel="Não" value="#{productMB.product.productDay.naoVenderQui}" /></td>
                                                    <td style="width: 14.28%; border: 1px solid black; border-collapse: collapse; padding: 15px; text-align: left;"><p:selectBooleanButton offLabel="Sim" onLabel="Não" value="#{productMB.product.productDay.naoVenderSex}" /></td>
                                                    <td style="width: 14.28%; border: 1px solid black; border-collapse: collapse; padding: 15px; text-align: left;"><p:selectBooleanButton offLabel="Sim" onLabel="Não" value="#{productMB.product.productDay.naoVenderSab}" /></td>
                                                </tr>
                                            </table>
                                        </div>
                                    </div>
                                </p:fieldset><br/><br/>
                                <p:fieldset legend="Turnos">
                                    <div class="ui-g ui-fluid">
                                        <div class="ui-sm-12 ui-g-12">
                                            <small>Defina aqui os turnos que você vende este produto</small>
                                        </div>
                                        <div class="ui-sm-4 ui-g-4">
                                            <h:outputLabel value="Manhã"/><br/>
                                            <p:selectBooleanButton value="#{productMB.product.shift.morning}" onLabel="Sim" offLabel="Não" disabled="#{companyMB.company.shift.begginMorning == null and companyMB.company.shift.endMorning == null}"/>
                                            <h:outputText value="De #{companyMB.company.shift.begginMorning} até #{companyMB.company.shift.endMorning}" rendered="#{companyMB.company.shift.begginMorning != null and companyMB.company.shift.endMorning != null}"/>
                                        </div>
                                        <div class="ui-sm-4 ui-g-4">
                                            <h:outputLabel value="Tarde"/><br/>
                                            <p:selectBooleanButton value="#{productMB.product.shift.afternoon}" onLabel="Sim" offLabel="Não" disabled="#{companyMB.company.shift.begginAfternoon == null and companyMB.company.shift.endAfternoon == null}"/>
                                            <h:outputText value="De #{companyMB.company.shift.begginAfternoon} até #{companyMB.company.shift.endAfternoon}" rendered="#{companyMB.company.shift.begginAfternoon != null and companyMB.company.shift.endAfternoon != null}"/>
                                        </div>
                                        <div class="ui-sm-4 ui-g-4">
                                            <h:outputLabel value="Noite"/><br/>
                                            <p:selectBooleanButton value="#{productMB.product.shift.night}" onLabel="Sim" offLabel="Não" disabled="#{companyMB.company.shift.begginNight == null and companyMB.company.shift.endNight == null}"/>
                                            <h:outputText value="De #{companyMB.company.shift.begginNight} até #{companyMB.company.shift.endNight}" rendered="#{companyMB.company.shift.begginNight != null and companyMB.company.shift.endNight != null}"/>
                                        </div>
                                    </div>
                                </p:fieldset>
                            </div>
                        </p:panel>
                    </p:tab>
                </p:tabView>
                <p:spacer height="30"/>
                <div id="main-buttons" style="text-align: right;">
                    <p:commandButton value="Salvar" action="#{productMB.save}" update="@form, :frmProduct" icon="fa fa-check" type="submit" styleClass="btn-primary" oncomplete="if (!args.validationFailed)  {PF('modalNewProduct').hide();}"/>
                </div>


            </h:form>
        </p:dialog>


        <p:dialog header="Ativar/inativar por categoria" id="mdlPararVenda" widgetVar="mdlPararVenda" height="auto" modal="true"
                  position="center">
            <h:form id="frmPararVenda">
                <div class="ui-g ui-fluid">
                    <div class="ui-g-12">
                        <p:outputLabel value="Situação"/><br/>
                        <p:selectBooleanButton value="#{productMB.situation}" offLabel="Inativo" onLabel="Ativo" required="true">
                            <p:ajax event="change" update="@this"/>
                        </p:selectBooleanButton>
                    </div>
                    <div class="ui-g-12">
                        <p:outputLabel value="Selecione uma categoria"/><br/>
                        <p:selectOneMenu value="#{productMB.category}" filter="true" filterMatchMode="contains" required="true" converter="Converter">
                            <f:selectItem itemLabel="Selecione uma categoria..." itemValue=""/>
                            <f:selectItems value="#{productMB.categoryList}" var="cat" itemLabel="#{cat.name}" itemValue="#{cat}" />
                            <p:ajax event="itemSelect" update="@this"/>
                        </p:selectOneMenu>
                    </div>
                </div><br/>
                <div id="main-buttons" style="text-align: right;">
                    <p:commandButton class="text-right" styleClass="btn-primary" action="#{productMB.stopSelling()}" value="Salvar" immediate="true" update=":frmProduct:tblProduct, @form"
                                     oncomplete="if (!args.validationFailed)  {PF('mdlPararVenda').hide();}"/>
                </div>
            </h:form>
        </p:dialog>
    </ui:define>
</ui:composition>
